import * as XLSX from "xlsx";

export const exportarClientesXLSX = (clientes) => {
    console.log("CLIENTES PARA EXPORTAR:", clientes.value);
    const encabezados = [
        "TIPO DE CONTRATO",
        "CLIENTE Nº",
        "CONTRATO Nº",
        "PROYECTO",
        "EMPRESA QUE VENDE",
        "RUC VENDEDOR",
        "DIRECCION VENDEDOR",
        "TIPO DE REPRESENTANTE",
        "REPRESENTANTE LEGAL - VENDEDOR",
        "DNI VENDEDOR",
        "Nº PARTIDA (PODER VENDEDOR)",
        "MONEDA",
        "NUM. CUENTA",
        "CCI",
        "FECHA DE ENTREGA DE PROYECTO",
        "FECHA DE FIRMA DE CONTRATO DEFINITIVO",
        "AREA MATRIZ HAS.",
        "REGISTROS DE",
        "PARTIDA MATRIZ",
        "UBICACION DEL LOTE (PREDIO MATRIZ)",
        "UNIDAD CATASTRAL DE MATRIZ",
        "URBANIZACION DE MATRIZ",
        "DISTRITO DE MATRIZ",
        "PROVINCIA DE MATRIZ",
        "DEPARTAMENTO DE MATRIZ",
        "COMPRAVENTA DE MATRIZ",
        "SITUACION LEGAL DE MATRIZ",
        "CONSTANCIA DE NO ADEUDO MUNICIPAL Y MAS DE MATRIZ",
        "AVANCE DE PROYECTO DE MATRIZ",
        "CRONOGRAMA DE MATRIZ",
        "FECHA INICIO CONTRATO",
        "FECHA CANCELACIÓN CONTRATO",
        "MZ-LT",
        "MZ",
        "LT",
        "ÁREA DEL LOTE (LETRAS)",
        "ÁREA DEL LOTE (CLIENTE)",
        "POR EL FRENTE",
        "POR LA DERECHA",
        "POR LA IZQUIERDA",
        "POR EL FONDO",
        "Nº IDENTIF. (CLIENTE)",
        "TIPO DOC. (CLIENTE)",
        "NOMBRES Y APELLIDOS (CLIENTE)",
        "OCUPACIÓN",
        "NACIONALIDAD (CLIENTE)",
        "ESTADO CIVIL (CLIENTE)",
        "DIRECCION(CLIENTE)",
        "DISTRITO (CLIENTE)",
        "PROVINCIA (CLIENTE)",
        "DEPARTAMENTO (CLIENTE)",
        "CORREO ELECTRONICO (CLIENTE)",
        "CELULAR (CLIENTE)",
        "NUMERO DE DOCUMENTO (CONYUGUE) (CLIENTE)",
        "TIPO DE DOCUMENTO (CONYUGUE) (CLIENTE)",
        "NOMBRE COMPLETO (CONYUGUE) (CLIENTE)",
        "ESTADO CIVIL (CONYUGUE) (CLIENTE)",
        "OCUPACIÓN (CONYUGE)",
        "DOMICILIO (CONYUGE)",
        "DISTRITO (CONYUGE)",
        "PROVINCIA (CONYUGE)",
        "DEPARTAMENTO (CONYUGE)",
        "COSTO DEL LOTE (CLIENTE) EN NUM",
        "COSTO DEL LOTE (CLIENTE) EN LETRAS",
        "PRECIO POR MT2",
        "PRECIO POR MT2 (EN LETRAS)",
        "CUOTA INICIAL (CLIENTE) INCLUYE SEPARACIÓN",
        "CUOTA INICIAL (CLIENTE) EN LETRAS",
        "CUOTA INICIAL (CLIENTE) FECHA DE PAGO",
        "CUOTA INICIAL (CLIENTE) CUENTA RECAUDADORA",
        "CUOTA INICIAL (CLIENTE)  BANCO",
        "SALDO DEL LOTE (CLIENTE)",
        "SALDO DEL LOTE (CLIENTE) EN LETRAS",
        "CANTIDAD DE CUOTAS (CLIENTE)",
        "CANTIDAD DE CUOTAS (CLIENTE) EN LETRAS",
        "CANTIDAD DE CUOTAS (CLIENTE) CUENTA RECAUDADORA",
        "CANTIDAD DE CUOTAS (CLIENTE) BANCO",
        "MONTO DE CUOTAS (CLIENTE)",
        "MONTO DE CUOTAS (CLIENTE) EN LETRAS",
        "CANTIDAD CUOTA EXTRAORDINARIA (CLIENTE)",
        "MONTO DE CUOTA EXTRAORDINARIA (CLIENTE)",
        "MANT.MENSUAL EN NUM (CLIENTE)",
        "MANT.MENSUAL EN LETRAS (CLIENTE)",
        "FECHA DE ENTREGA (CLIENTE)",
        "ESTADO DE CUENTA (CLIENTE) (DE TENER DEUDA PONER MONTO)",
        "MONTO DE DEUDA EN LETRAS (CLIENTE)",
        "CUOTAS PENDIENTES DE PAGO",
        "LETRAS PENDIENTES DE PAGO",
        "ENVIO DE MINUTA (CLIENTE)",
        "FECHA DE CITA (CLIENTE)",
        "HORA DE CITA (CLIENTE)",
        "MODIF. MINUTA  (CLIENTE) (SI/NO)",
        "EXP. NOTARIA",
        "FIRMO",
    ];

    const filas = clientes.map((item) => {
        const cliente = item ?? {};
        const lote = item.lote ?? {};
        const lindero = lote.lindero ?? {};
        const cuota = lote.cuota ?? {};
        const copropietario = cliente.copropietarios?.[0]?? {};
        const conyuge = cliente.conyuge ?? {};
        const cuotaExtra = lote.cuotasExtraordinarias?.[0] ?? {};

        return [
            lote.contrato ?? '-',
            lote.codigoLoteCliente ?? '-',
            lote.idLote ?? '-',
            lote.tipoProyecto ?? '-',
            lote.empresaVende ?? '-',
            lote.rucVendedor ?? '-',
            lote.direccionVendedor ?? '-',
            lote.tipoRepresentante ?? '-',
            lote.representanteLegalVendedor ?? '-',
            lote.dniVendedor ?? '-',
            lote.numeroPartidaPoderVendedor ?? '-',
            lote.moneda ?? '-',
            lote.numCuenta ?? '-',
            lote.cci ?? '-',
            lote.fechaSale ?? '-',
            lote.fechaFirmaContratoDefinitivo ?? '-',
            lote.fechaInicioContrato ?? '-',
            lote.fechaCancelacionContrato ?? '-',
            lote.manzana && lote.numeroLote ? `MZ ${lote.manzana} - LT ${lote.numeroLote}` : '-',
            lote.manzana ?? '-',
            lote.numeroLote ?? '-',
            lote.areaLoteLetras ?? '-',
            lote.areaLote ?? '-',
            lindero.porElFrente ?? '-',
            lindero.porLaDerecha ?? '-',
            lindero.porLaIzquierda ?? '-',
            lindero.porElFondo ?? '-',
            cliente.numeroIdentificacion ?? '-',
            cliente.documentoIdentificacion ?? '-',
            cliente.nombresApellidos ?? '-',
            cliente.nacionalidad ?? '-',
            cliente.estadoCivil ?? '-',
            copropietario.estadoCivilCopropietarios ?? '-',
            copropietario.direccionCopropietarios ?? '-',
            cliente.distrito ?? '-',
            cliente.provincia ?? '-',
            cliente.departamento ?? '-',
            cliente.ocupacion ?? '-',
            item.tipoSocio ?? '-',
            conyuge.numeroIdentificacionConyuge ?? '-',
            conyuge.documentoIdentificacionConyuge ?? '-',
            conyuge.nombresApellidosConyuge ?? '-',
            conyuge.estadoCivilConyuge ?? '-',
            conyuge.ocupacionConyuge ?? '-',
            conyuge.direccionConyuge ?? '-',
            conyuge.distritoConyuge ?? '-',
            conyuge.provinciaConyuge ?? '-',
            conyuge.departamentoConyuge ?? '-',
            lote.costoLote ?? '-',
            lote.costoLoteLetras ?? '-',
            lote.precioMetroCuadrado ?? '-',
            lote.precioMetroCuadradoLetras ?? '-',
            cuota.cuotaInicialIncluyeSeparacion ?? '-',
            cuota.cuotaInicialIncluyeSeparacionLetras ?? '-',
            cuota.fechaPago ?? '-',
            cuota.cuentaRecaudadora ?? '-',
            cuota.cuotaInicialBanco ?? '-',
            cuota.saldoLote ?? '-',
            cuota.saldoLoteLetras ?? '-',
            cuota.cantidadCuotas ?? '-',
            cuota.cantidadCuotaLetras ?? '-',
            cuota.cantidadCuotaCuentaRecaudadora ?? '-',
            cuota.cantidadCuotaBanco ?? '-',
            cuota.montoCuotas ?? '-',
            cuota.montoCuotaLetras ?? '-',
            cuotaExtra.cantidadCuotaExtraordinaria ?? '-',
            cuotaExtra.montoCuotaExtraordinaria ?? '-',
            lote.mantenimientoMensual ?? '-',
            lote.mantenimientoMensualLetras ?? '-',
            cuotaExtra.fechaEntrega ?? '-',
            lote.estadoCuenta ?? '-',
            lote.montoDeudaLetra ?? '-',
            cuota.cuotaPendientePago ?? '-',
            cuota.letrasPendientePago ?? '-',
            cuotaExtra.cartaNoAdeudo ?? '-',
            cuotaExtra.certificadoLote ?? '-',
            cuotaExtra.mediosPago ?? '-',
            cuotaExtra.plano1 ?? '-',
            cuotaExtra.plano2 ?? '-',
            cuotaExtra.envioMinuta ?? '-',
            cliente.correoElectronico ?? '-',
            cliente.celularCliente ?? '-',
            cuotaExtra.fechaCita ?? '-',
            cuotaExtra.horaCita ?? '-',
            cuotaExtra.modificarMinuta ?? '-',
            cuotaExtra.minutaEscaneada ?? '-',
            cuotaExtra.expNotaria ?? '-',
            item.firmo ?? '-',
        ];
    });

    const hoja = XLSX.utils.aoa_to_sheet([encabezados, ...filas]);
    const libro = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(libro, hoja, "Clientes");
    XLSX.writeFile(libro, "clientes.xlsx");
};
